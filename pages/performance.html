<!DOCTYPE html>
<html>

<head>
  <link rel="stylesheet" href="/css/styles.css"/>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.3/dist/Chart.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datasource@0.2.0/dist/chartjs-plugin-datasource.min.js">
  </script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


  <script>
    $(function () {
      // Load the header HTML file
      $("#header-container").load("/data/header");
    });
  </script>
</head>

<body class="p-4">
  <div id="header-container"></div>
  <center>
    <h2>Feature Collection Performance</h2>
  </center>

  <div class="container">

    <div class="inner-div" >
      <center><b>Development Performance Graphs</b> </center> 
   
      <a href="/dashboard/performance/dev/1"> 1 day </a>|
      <a href="/dashboard/performance/dev/3"> 3 days </a>|
      <a href="/dashboard/performance/dev/7"> 7 days </a>|
      <a href="/dashboard/performance/dev/14"> 14 days </a>|
      <a href="/dashboard/performance/dev/30"> 30 days </a>|
      <a href="/dashboard/performance/dev/All"> All </a>
    </div>
  
    <div class="inner-div" >
      <center> <b>Test Performance Graphs</b></center> 
      <a href="/dashboard/performance/test/1"> 1 day </a>|
      <a href="/dashboard/performance/test/3"> 3 days </a>|
      <a href="/dashboard/performance/test/7"> 7 days </a>|
      <a href="/dashboard/performance/test/14"> 14 days </a>|
      <a href="/dashboard/performance/test/30"> 30 days </a>|
      <a href="/dashboard/performance/test/All"> All </a>
    </div>
   <div class="inner-div" >
      <center><b>Staging Performance Graphs</b> </center>
      <a href="/dashboard/performance/staging/1"> 1 day </a>|
      <a href="/dashboard/performance/staging/3"> 3 days </a>|
      <a href="/dashboard/performance/staging/7"> 7 days </a>|
      <a href="/dashboard/performance/staging/14"> 14 days </a>|
      <a href="/dashboard/performance/staging/30"> 30 days </a>|
      <a href="/dashboard/performance/staging/All"> All </a>
    </div>
  </div>
<br>

  <div id="chart-container" class="row"></div>

  <script>
    // const path = window.location.pathname;
    // const currentPath = path.split("/");
    // const lastTwoParts = currentPath.slice(-2);
    // const [parameter1, parameter2] = lastTwoParts;

    // console.log(currentPath);
    // console.log(lastTwoParts);

    // const [environmentName, days] = lastTwoParts;
    // URLKeys = "/histresultskeys/" + environmentName;
    // console.log("URLKeys are: " + URLKeys);

    // apiUrl = "/histresultsdays/" + environmentName + "/" + days;
    // console.log("apiUrl are: " + apiUrl);

    // // Fetch data from API
    // async function fetchData() {
    //   const response = await fetch("/histresultskeys/" + environmentName);
    //   const jsonData = await response.json();
    //   // return the array of transactions in file
    //   return jsonData;
    // }

    // async function createCharts() {
    //   const chartContainer = document.getElementById("chart-container");

    //   let transactions = await fetchData();

    //   for (const value of transactions) {
    //     const url =
    //       "/histresultsdays/" + environmentName + "/" + value + "/" + days;
    //     const response = await fetch(url);
    //     const mydata = await response.json();
    //     console.log(`Response for ${value}: `, mydata);
    //     // console.log(`AvgResponseTime: `, AvgResponseTime);
    //     //Build charts for each array and add to page

    //     const chartCard = document.createElement("div");
    //     chartCard.classList.add("col-md-4");

    //     const card = document.createElement("div");
    //     card.classList.add("card");

    //     const cardHeader = document.createElement("div");

    //     cardHeader.classList.add("card-header", "text-center");
    //     cardHeader.innerHTML = value; // Use the value as the card header text
    //     card.appendChild(cardHeader);

    //     const cardBody = document.createElement("div");
    //     cardBody.classList.add("card-body");

    //     const canvas = document.createElement("canvas");
    //     const chart = new Chart(canvas, {
    //       type: "line",
    //       data: {
    //         labels: mydata.map((d) => d.DateTime),
    //         datasets: [{
    //           label: Array.from(mydata)[0].key,
    //           data: mydata.map((d) => d.AvgResponseTime),
    //           fill: false,
    //           backgroundColor: "rgba(255, 99, 132, 0.2)",
    //           borderColor: "rgba(255, 99, 132, 1)",
    //           tension: 0.1,
    //         }, ],
    //       },
    //       options: {
    //         scales: {
    //           x: {
    //             type: "time",
    //             distribution: "series",
    //             bounds: "data",
    //             time: {
    //               parser: "YYYY-MM-DD HH:mm:ss",
    //               displayFormats: {
    //                 millisecond: "MMM DD",
    //                 second: "MMM DD",
    //                 minute: "MMM DD",
    //                 hour: "MMM DD",
    //                 day: "MMM DD",
    //                 week: "MMM DD",
    //                 month: "MMM DD",
    //                 quarter: "MMM DD",
    //                 year: "MMM DD",
    //               },
    //             },
    //           },
    //           y: {
    //             label: "Avg Response Time (ms)",
    //           },
    //         },
    //         plugins: {},
    //       },
    //     });

    //     cardBody.appendChild(canvas);
    //     card.appendChild(cardBody);
    //     chartCard.appendChild(card);
    //     chartContainer.appendChild(chartCard);
    //   }
    // }

    // createCharts();
  </script>
  <br>
  <div class="card">
    <div class="card-body">
      <p class="card-text custom-card-text">All response times for failed tests are removed automatically. If
        there are any performance spikes that distort graphs and can be explained,
        they can be removed from the graphs by editing the associated results
        history file and setting "IncludeInStats" key to 0 . A "RemoveComment" key
        can be used to add the reason for the removal of the data.</p>
      <ol>

      </ol>
    </div>
  </div>
  <script src="/js/performance.js"></script>
</body>

</html>